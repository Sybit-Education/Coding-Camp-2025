<div
  class="flex flex-col items-center justify-center rounded-2xl bg-[var(--colors-light-blue)] p-5 text-lg leading-relaxed text-shadow-gray-500"
>
  <form
    class="grid gap-[3rem] rounded-2xl bg-white p-6 sm:grid-cols-[1fr] md:w-full md:grid-cols-[1fr_1fr]"
  >
    <!-- Linke Spalte mit vertikalem Abstand -->
    <div class="flex flex-col space-y-4">
      <!-- Event Name -->
      <ng-container *ngIf="!this.errorName; else errorName">
        <div>
          <label for="eventName" class="required">{{
            'create-event.eventname' | translate
          }}</label>
          <input
            id="eventName"
            name="eventName"
            type="text"
            [(ngModel)]="eventName"
            class="p-[0.75rem 1rem] w-full"
            required
          />
        </div>
      </ng-container>
      <ng-template #errorName>
        <div>
          <label
            for="errorName"
            class="required mb-2 block text-sm font-medium text-red-700 dark:text-red-500"
            >{{ 'create-event.eventname' | translate }}</label
          >
          <input
            type="text"
            id="errorName"
            class="p-[0.75rem 1rem] block w-full rounded-lg border border-red-500 bg-red-50 p-2.5 text-sm text-red-900 placeholder-red-700 focus:border-red-500 focus:ring-red-500"
            [(ngModel)]="eventName"
            name="eventName"
          />
          <p class="mt-2 text-sm text-red-600 dark:text-red-500">
            {{'create-event.error.name' | translate}}
          </p>
        </div>
      </ng-template>

      <!-- Veranstalter Auswahl -->
      <div>
        <select
          id="organizer"
          name="organizer"
          [(ngModel)]="selectedOrganizer"
          (ngModelChange)="setOrganizer($event)"
          class="p-[0.75rem 1rem] w-full cursor-pointer"
        >
          <option [ngValue]="null">
            {{ 'create-event.organizer' | translate }}
          </option>
          @for (organizer of organizers; track organizer) {
            <option [ngValue]="organizer">
              {{ organizer.name }}
            </option>
          }
        </select>
        <button
          type="button"
          class="mt-2 w-full rounded-2xl bg-[var(--colors-light-blue)] p-2 text-white"
          (click)="newOrganizer = !newOrganizer"
        >
          {{ 'create-event.neworganizer' | translate }}
        </button>
      </div>

      <!-- Neuer Veranstalter -->
      @if (newOrganizer) {
        <div class="space-y-2 rounded-xl border-2 border-black p-2">
          <p>
            <label for="organizername">{{
              'create-event.neworganizername' | translate
            }}</label>
            <input
              id="organizername"
              name="organizername"
              type="text"
              [(ngModel)]="organizername"
              class="p-[0.75rem 1rem] w-full"
              required
            />
          </p>
          <p>
            <label for="organizerphone">{{
              'create-event.neworganizerphone' | translate
            }}</label>
            <input
              id="organizerphone"
              name="organizerphone"
              type="number"
              [(ngModel)]="organizerphone"
              class="p-[0.75rem 1rem] w-full"
            />
          </p>
          <p>
            <label for="organizermail">{{
              'create-event.neworganizermail' | translate
            }}</label>
            <input
              id="organizermail"
              name="organizermail"
              type="text"
              [(ngModel)]="organizermail"
              class="p-[0.75rem 1rem] w-full"
            />
          </p>
        </div>
      }

      <!-- Datum und Zeit -->

      <div class="grid grid-cols-2 gap-[1rem]">
        <ng-container *ngIf="!this.errorDate; else errorDate">
          <div>
            <label for="date" class="required">{{
              'create-event.startdate' | translate
            }}</label>
            <input
              id="date"
              type="date"
              [(ngModel)]="dateStart"
              name="dateStart"
              class="p-[0.75rem 1rem] w-full"
            />
          </div>
        </ng-container>
        <ng-template #errorDate>
          <div>
            <label
              for="errorDate"
              class="required mb-2 block text-sm font-medium text-red-700 dark:text-red-500"
              >{{ 'create-event.startdate' | translate }}</label
            >
            <input
              type="date"
              id="errorDate"
              class="p-[0.75rem 1rem] block w-full rounded-lg border border-red-500 bg-red-50 p-2.5 text-sm text-red-900 placeholder-red-700 focus:border-red-500 focus:ring-red-500"
              [(ngModel)]="dateStart"
              name="dateStart"
            />
            <p class="mt-2 text-sm text-red-600 dark:text-red-500">
              {{'create-event.error.date' | translate}}
            </p>
          </div>
        </ng-template>
        <ng-container *ngIf="!this.errorTime; else errorTime">
          <div>
            <label for="time" class="required">{{
              'create-event.starttime' | translate
            }}</label>
            <input
              id="time"
              type="time"
              [(ngModel)]="timeStart"
              name="timeStart"
              class="p-[0.75rem 1rem] w-full"
            />
          </div>
        </ng-container>
        <ng-template #errorTime>
          <div>
            <label
              for="errorTime"
              class="required mb-2 block text-sm font-medium text-red-700 dark:text-red-500"
              >{{ 'create-event.starttime' | translate }}</label
            >
            <input
              type="time"
              id="errorTime"
              class="p-[0.75rem 1rem] block w-full rounded-lg border border-red-500 bg-red-50 p-2.5 text-sm text-red-900 placeholder-red-700 focus:border-red-500 focus:ring-red-500"
              [(ngModel)]="timeStart"
              name="timeStart"
            />
            <p class="mt-2 text-sm text-red-600 dark:text-red-500">
              {{'create-event.error.time' | translate}}
            </p>
          </div>
        </ng-template>
      </div>

      @if (timePeriode) {
        <div class="grid grid-cols-2 gap-[1rem]">
          <div>
            <label for="date">{{ 'create-event.enddate' | translate }}</label>
            <input
              id="date"
              type="date"
              [(ngModel)]="dateEnd"
              name="dateStart"
              class="p-[0.75rem 1rem] w-full"
            />
          </div>
          <div>
            <label for="time">{{ 'create-event.endtime' | translate }}</label>
            <input
              id="time"
              type="time"
              [(ngModel)]="timeEnd"
              name="timeStart"
              class="p-[0.75rem 1rem] w-full"
            />
          </div>
        </div>
      }
      <div class="grid grid-cols-[1rem_1rem]">
        <input
          id="timePeriode"
          name="timePeriode"
          type="checkbox"
          [(ngModel)]="timePeriode"
          class="h-4 w-4 cursor-pointer"
        />
        <label for="timePeriode" class="ms-2 w-full cursor-pointer">
          {{ 'create-event.timespan' | translate }}
        </label>
      </div>

      <!-- Location Auswahl -->
      <div>
        <select
          id="location"
          name="location"
          [(ngModel)]="selectedLocation"
          (ngModelChange)="setLocation($event)"
          class="p-[0.75rem 1rem] w-full cursor-pointer"
        >
          <option [ngValue]="null">
            {{ 'create-event.location' | translate }}
          </option>
          @for (location of locations; track location) {
            <option [ngValue]="location">
              {{ location.name }}
            </option>
          }
        </select>
        <button
          type="button"
          class="mt-2 w-full rounded-2xl bg-[var(--colors-light-blue)] p-2 text-white"
          (click)="newLocation = !newLocation"
        >
          {{ 'create-event.newlocation' | translate }}
        </button>
      </div>

      <!-- Neue Location -->
      @if (newLocation) {
        <div class="space-y-2 rounded-xl border-2 border-black p-2">
          <label for="locationName">{{
            'create-event.newlocationname' | translate
          }}</label>
          <input
            id="locationName"
            name="locationName"
            type="text"
            [(ngModel)]="locationName"
            placeholder="{{
              'create-event.newlocationnameexample' | translate
            }}"
            class="p-[0.75rem 1rem] w-full"
          />
          <label for="address">{{
            'create-event.newlocationaddress' | translate
          }}</label>
          <input
            id="address"
            name="address"
            type="text"
            [(ngModel)]="address"
            placeholder="{{
              'create-event.newlocationaddressexample' | translate
            }}"
            class="p-[0.75rem 1rem] w-full"
          />
          <div class="grid grid-cols-2 gap-[1rem]">
            <div>
              <label for="postalCode">{{
                'create-event.newlocationplz' | translate
              }}</label>
              <input
                id="postalCode"
                name="plz"
                type="number"
                [(ngModel)]="plz"
                class="p-[0.75rem 1rem] w-full"
              />
            </div>
            <div>
              <label for="city">{{
                'create-event.newlocationcity' | translate
              }}</label>
              <input
                id="city"
                name="city"
                type="text"
                [(ngModel)]="city"
                required
                class="p-[0.75rem 1rem] w-full"
              />
            </div>
          </div>
        </div>
      }

      <!-- Mindestalter -->
      <div>
        <label for="age">{{ 'create-event.age' | translate }}</label>
        <input
          id="age"
          name="age"
          type="number"
          min="0"
          [(ngModel)]="age"
          class="p-[0.75rem 1rem] w-full"
          placeholder="{{ 'create-event.ageexample' | translate }}"
        />
      </div>

      <!-- Preis -->
      <div>
        <label for="price">{{ 'create-event.price' | translate }}</label>
        <input
          id="price"
          name="price"
          type="number"
          min="0"
          step="0.01"
          placeholder="0.00"
          [(ngModel)]="price"
          class="p-[0.75rem 1rem] w-full"
        />
      </div>

      <div class="required m-0 mt-5"></div>
      <div>
        <p>{{ 'create-event.hint' | translate }}</p>
      </div>
    </div>

    <!-- Rechte Spalte mit vertikalem Abstand -->
    <div class="flex flex-col space-y-4">
      <!-- Beschreibung -->
      <div>
        <label for="description">{{
          'create-event.description' | translate
        }}</label>
        <textarea
          id="description"
          name="description"
          [(ngModel)]="description"
          class="p-[0.75rem 1rem] w-full"
        ></textarea>
      </div>

      <!-- Einschränkungen -->
      <div>
        <label for="restriction">{{
          'create-event.restrictions' | translate
        }}</label>
        <input
          id="restriction"
          name="restriction"
          type="text"
          [(ngModel)]="restriction"
          class="p-[0.75rem 1rem] w-full"
          placeholder="{{ 'create-event.restrictionsexample' | translate }}"
        />
      </div>

      <!-- Themen -->
      <h3>
        {{ 'create-event.topics' | translate }}
      </h3>
      <div
        id="choose-category"
        class="rounded-lg bg-white shadow-sm dark:bg-gray-100"
      >
        <ul class="space-y-1 p-3 text-sm text-gray-700 dark:text-gray-200">
          @for (topic of topics; track topic) {
            <li>
              <div
                class="flex items-center rounded-sm p-2 hover:bg-gray-100 dark:hover:bg-gray-300"
              >
                <input
                  id="checkbox{{ topic.id }}"
                  name="topicCheckbox{{ topic.id }}"
                  type="checkbox"
                  [value]="topic.id"
                  [checked]="selectedTopics.includes(topic)"
                  (change)="toggleTopicSelection($event, topic)"
                  class="h-4 w-4 cursor-pointer rounded-sm border-gray-300 bg-gray-100 text-[var(--colors-light-blue)]"
                />
                <label
                  for="checkbox{{ topic.id }}"
                  class="ms-2 w-full cursor-pointer text-sm font-medium text-gray-900 dark:text-gray-700"
                >
                  {{ topic.name }}
                </label>
              </div>
            </li>
          }
        </ul>
      </div>

      <!-- Event-Typ -->
      <div>
        <select
          id="eventType"
          name="eventType"
          [(ngModel)]="selectedEventType"
          (ngModelChange)="setSelectedEventType($event)"
          class="p-[0.75rem 1rem] border-Gray-600 w-full cursor-pointer rounded-[6px] border-2"
        >
          <option [ngValue]="null">
            {{ 'create-event.topics' | translate }}
          </option>
          @for (eventType of eventTypes; track eventType) {
            <option [ngValue]="eventType">
              {{ eventType.name }}
            </option>
          }
        </select>
      </div>

      <!-- Mehr Infos -->
      <div>
        <label for="moreInfoLink">{{
          'create-event.moreinfo' | translate
        }}</label>
        <input
          id="moreInfoLink"
          name="moreInfoLink"
          type="text"
          placeholder="{{ 'create-event.moreinfoexample' | translate }}"
          [(ngModel)]="moreInfoLink"
          class="p-[0.75rem 1rem] w-full"
        />
      </div>

      <div
        class="flex flex-col items-center justify-center rounded-[6px] border-2 border-black bg-[#6d7cbc]"
      >
        <button
          class="flex h-[250px] w-full flex-col items-center justify-center"
          (dragover)="onDragOver($event)"
          (dragleave)="onDragLeave()"
          (drop)="onDrop($event)"
          (keydown)="onAreaClick()"
          (click)="onAreaClick()"
          tabindex="0"
          [class.hovering]="isDragging"
        >
          <div class="mb-2 text-[1.1rem] font-medium text-white">
            {{ 'Bild hier ablegen oder klicken zum Auswählen' }}
          </div>
          <div class="text-[0.9rem] text-black">
            {{ 'JPG, PNG - Max. 5 MB pro Bild' }}
          </div>
          <input
            #fileInput
            type="file"
            multiple
            [attr.accept]="'image/png, image/jpeg'"
            (change)="onFilesSelected($event)"
            style="display: none"
          />
        </button>

        @if (previews.length) {
          @for (src of previews; track src; let i = $index) {
            <div class="m-1 rounded-lg border-2 border-gray-500">
              <div
                class="relative inline-block overflow-hidden rounded-md bg-white align-top leading-none"
              >
                <img
                  [src]="src"
                  alt="Bild-Vorschau {{ i + 1 }}"
                  class="block rounded-md"
                />
                <button
                  (click)="removeImage(i)"
                  class="absolute top-1 right-1 flex h-8 w-8 items-center justify-center rounded-full border border-gray-300 bg-white/80 shadow-md hover:bg-gray-500 hover:text-white"
                >
                  ✕
                </button>
              </div>
            </div>
          }
        }
      </div>

      <!-- Button: Event erstellen -->
      @if (this.errorDate || this.errorName || this.errorTime) {
        <div>
          <p class="mt-2 text-sm text-red-600 dark:text-red-500">
            {{'create-event.error.general' | translate}}
          </p>
        </div>
      }
      
      <div>
        <button
          type="submit"
          class="w-full cursor-pointer rounded-2xl bg-[var(--colors-light-blue)] p-5 text-white"
          (click)="saveEvent()"
        >
          {{ 'create-event.createevent' | translate }}
        </button>
      </div>
    </div>
  </form>
</div>
