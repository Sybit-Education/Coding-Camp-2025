<app-go-back-button> </app-go-back-button>
<article>
  <h1>
    {{ this.name }}
  </h1>
  
  @if(this.description) {
    <p [innerHTML]="this.description" class="lg:text-lg text-sm text-gray-600 hyphens-auto">
      {{ this.description }}
    </p>
  }

  <!-- Search input -->
  <div class="mb-4">
    <label class="sr-only" for="category-search">{{ 'SEARCH.LABEL' | translate }}</label>
    <input
      id="category-search"
      type="search"
      class="w-full rounded-2xl border border-gray-300 p-2"
      [value]="searchTerm"
      (input)="onSearchChange(($any($event.target)).value)"
      [attr.aria-label]="'SEARCH.LABEL' | translate"
      [placeholder]="'SEARCH.PLACEHOLDER' | translate"
      [attr.aria-busy]="searching"
    />
    @if (searching) {
      <div class="mt-2 flex items-center text-sm text-gray-500" aria-live="polite" aria-busy="true">
        <span class="mr-2 inline-block h-4 w-4 animate-spin rounded-full border-2 border-t-transparent border-[#c70d56]"></span>
        {{ 'SEARCH.SEARCHING' | translate }}
      </div>
    }
  </div>

  <!-- Ladeanzeige (nur für Initial-Load, nicht während der Suche) -->
  @if (loading && !searchTerm) {
    <app-loading-spinner />
    <div class="mr-2 ml-2 grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3">
      @for (item of [].constructor(3); track $index) {
        <div class="mx-auto w-full rounded rounded-2xl bg-white shadow-lg">
          <div class="h-48 animate-pulse overflow-hidden bg-gray-200 p-3"></div>
          <div class="h- p-3">
            <div class="mt-2 grid grid-cols-2 gap-4">
              <div class="col-span-2 h-8 animate-pulse rounded bg-gray-200"></div>
              <div class="h-4 animate-pulse rounded bg-gray-200"></div>
              <div class="h-4 animate-pulse rounded bg-gray-200"></div>
              <div class="h-4 animate-pulse rounded bg-gray-200"></div>
              <div class="h-4 animate-pulse rounded bg-gray-200"></div>
            </div>
          </div>
        </div>
      }
      </div>
  }

  <!-- Keine Events Meldung -->
  @if (!loading && events.length === 0) {
    <div class="rounded-lg bg-gray-100 p-4 text-center">
      <p>
        {{ 'EVENTS.NO_EVENTS_FOUND_IN_CATEGORY' | translate }}
      </p>
    </div>
  }

  <div class="grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3">
    @for (event of events; track trackByEvent($index, event)) {
      <div class="relative">
        <app-event-card [event]="event" [class.opacity-70]="event.isPast"> </app-event-card>
      </div>
    }
  </div>
</article>
